---
import "../../styles/home.css";

// Génération des pages statiques
export async function getStaticPaths() {
  const allSeries = Object.values(
    import.meta.glob("../../../content/series/*.md", { eager: true })
  );

  return allSeries.map((serie) => ({
    params: {
      slug: serie.frontmatter.slug,
    },
    props: {
      serie,
      allSeries,
    },
  }));
}

const { serie, allSeries } = Astro.props;
const { title, images } = serie.frontmatter;
const Content = serie.Content;
---

<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <title>{title} – Raphaelle Brui</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  </head>

  <body class="page-series">

    <!-- HEADER GLOBAL -->
    <header class="site-header">
      <div class="brand">
        <a href="/">Raphaelle Brui</a>
      </div>

      <nav class="main-nav">
        <a href="/">Accueil</a>

        {allSeries.map((s) => (
          <a
            href={`/series/${s.frontmatter.slug}/`}
            class={s.frontmatter.slug === serie.frontmatter.slug ? "active" : ""}
          >
            {s.frontmatter.title}
          </a>
        ))}

        <a href="/contact/">Contact</a>
      </nav>
    </header>

    <!-- CONTENU DE LA SÉRIE -->
    <main class="series">

      <!-- TEXTE DE PRÉSENTATION -->
      <section class="series-intro">
        <h1>{title}</h1>

        <div class="series-text">
          <Content />
        </div>
      </section>

      <!-- IMAGES -->
      <section class="series-images">
        {images.map((image) => (
          <figure class="series-image">
            <img
              src={image.url}
              alt={image.title || ""}
              loading="lazy"
            />

            {(image.title || image.caption) && (
              <figcaption>
                {image.title && <strong>{image.title}</strong>}
                {image.caption && <p>{image.caption}</p>}
              </figcaption>
            )}
          </figure>
        ))}
      </section>

    </main>

  </body>
</html>
